# 世界书生成器 (World Book Generator)

**一个为 SillyTavern 设计的、专业的、AI驱动的世界观构建与剧情生成扩展。**

本扩展旨在将复杂、繁琐的世界书创作过程，简化为一个清晰、高效、充满创造力的流水线。无论您是想构建一个宏大的史诗世界，还是一个精巧的短篇故事背景，本工具都能为您提供从灵感激发到完整世界书导出的一站式解决方案。

---

## 核心模式

本插件提供两种截然不同的创作模式，以满足不同用户的需求：

### 模式一：👨‍🎨 手动引导式创作 (Manual Guided Creation)

适合希望完全掌控创作过程的专业作者。此模式将创作分解为四个可以随时切换的独立阶段：

1.  **世界基石**: 通过高级元素池激发灵感，构建世界的核心概念与宏观背景。
2.  **剧情构思**: 在世界框架内，设计核心冲突、故事大纲与主要角色。新增**“男频/女频”创作频道**，提供更有针对性的剧情灵感。
3.  **细节填充**: 对已有的设定（人物、地点、势力等）进行深入、细致的描绘。
4.  **机制设计**: 为你的世界添加独特的游戏规则、魔法系统或科技体系。

### 模式二：🚀 全自动一键生成 (Fully Automated Generation)

适合追求极致效率的创作者。您只需提供一个核心创意或主题，AI将为您完成剩下的一切：

-   **智能任务分解**: AI“导演”会首先将您的核心创意，智能地分解为四个阶段的具体、详细、可执行的创作指令。
-   **全流程自动执行**: 插件将自动、依次地执行所有创作阶段，从宏观背景到具体机制，无需任何人工干预。
-   **配套角色卡生成**: 在世界书创建完毕后，插件会自动为您创建一个配套的“导演”角色卡，并将其与新生成的世界书绑定，实现真正的“开箱即玩”。

---

## ✨ 专业级功能亮点

-   **🤖 后台任务 & 状态恢复**: 全自动生成是一个真正的后台任务。您可以关闭弹窗，任务会继续在后台运行。当您再次打开插件时，可以无缝恢复并查看实时进度。
-   **🔧 强大容错机制**: 自动化流程拥有极其健壮的容错能力。当AI调用或数据解析失败时，系统会智能地、精准地**重试失败的核心任务**，而不是粗暴地中断整个流程，极大地提高了长时间、多批量生成任务的成功率。
-   **⚙️ 执行次数自定义**: 在全自动模式下，您可以为每个创作阶段（基石、剧情、细节、机制）自定义1-10次的执行次数，以生成更丰富、更多样化的世界书内容。
-   **🔌 自定义API支持**: 您现在可以配置并使用自己的、符合OpenAI规范的API端点，绕过酒馆内置AI，使用更强大或更专业的模型。
-   **🎲 海量灵感元素池**: 内置数百个精心设计的设定选项，覆盖世界观、剧情、细节、机制等方方面面，可通过随机组合，一键激发您的创作灵感。
-   **💾 断点续传与自由创作**: 随时可以中断和继续之前的工作。加载已有世界书后，可在任意阶段自由切换，进行补充和修改。
-   **👆 可拖动悬浮按钮**: 插件入口是一个可自由拖动的悬浮按钮，绝不遮挡您的聊天窗口。
-   **🔄 智能更新系统**: 内置自动更新检查功能，并允许用户在设置中自由开关，确保您能第一时间获取最新、最强大的版本。

## 🚀 安装与使用

SillyTavern 支持直接通过链接安装扩展，这是最推荐的安装方式。

1.  打开 SillyTavern，点击右上角的 **扩展** 图标 (一个骰子 🎲 的形状)。
2.  在扩展页面中，点击 **安装扩展** (Install Extension) 按钮。
3.  在弹出的对话框中，将以下仓库链接粘贴到输入框内：
    ```
    https://github.com/your-github-username/world-book-generator
    ```
    *(请将 `your-github-username` 替换为实际的Github用户名)*
4.  点击 `Install` 进行安装。
5.  安装完成后，系统可能会提示您重新加载UI，请按提示操作。
6.  在扩展列表中找到并启用 "世界书生成器"。
7.  点击屏幕右下角新增的浮动按钮即可开始使用。

## 📜 近期重要更新

-   **v19.x**: 实现了全自动生成流程结束后，自动创建并绑定配套“导演”角色卡的功能。
-   **v18.x**: 修复了UI逻辑，并对代码质量进行了全面的审查和优化。
-   **v17.x**: 将重试机制升级为“重试整个阶段的完整逻辑”，以应对更复杂的错误场景。
-   **v16.x**: 重构了重试机制，实现了更高效、更精准的核心任务重试。
-   **v15.x**: 首次为自动化任务引入了强大的容错与重试机制。
-   **v14.x**: 为全自动生成模式增加了“各阶段执行次数”的自定义配置功能。
-   **v13.x**: 集成了自定义API功能，允许连接到第三方AI服务。
-   **v12.x**: 将全自动生成重构为真正的后台任务，并支持状态恢复。
-   **v11.x**: 首次引入了全新的“全自动生成”模式。

*(更早的详细更新日志请参见项目内的 `项目文档.txt` 文件)*
